---
title: "hw5"
author: "Matthew Spotnitz"
date: "11/14/2021"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(ggplot2)
```

```{r}
homicide_df = read.csv("homicide-data.csv")
head(homicide_df)
tail(homicide_df)
str(homicide_df)
view(homicide_df)
```
This data set consists of 52179 observations and 12 variables.  Of those variables, all are characters except for "lat" and "lon", which are integers.

```{r}
homicide_df = janitor::clean_names(homicide_df)
homicide_df = homicide_df %>% mutate (
  city_state = str_c(city, state),
  resolution = case_when(
    disposition == "Closed without arrest" ~ "unsolved",
    disposition == "Open/No arrest" ~ "unsolved",
    disposition == "Closed by arrest" ~ "solved" 
  )) %>% 
  relocate(city_state) %>% 
  filter(city_state != "TulsaAL")
```
Now I will focus on Baltimore, MD
```{r}
baltimore_df = homicide_df %>% filter(city_state == "BaltimoreMD")

baltimore_summary = baltimore_df %>% summarize(
  unsolved = sum(resolution == "unsolved"), n = n()
) 

baltimore_test = prop.test(
  x = baltimore_summary %>% pull(unsolved),
  n = baltimore_summary %>% pull(n)
)

baltimore_test %>% broom::tidy()

```
Now I will iterate this function.